import{j as e,f as L,c as y,S as P,B as b,D,A as _,g as w,s as A,Q as z,T as B}from"./localStorage.DZHSJ0tP.js";import{r as c}from"./index.DhYZZe0J.js";const M=({question:s,totalQuestions:r})=>{const t=s/r*100;return e.jsxs("div",{children:[e.jsx("h4",{className:"sr-only",children:"Status"}),e.jsxs("p",{className:"text-sm font-medium text-gray-900",children:["Question ",s," / ",r]}),e.jsx("div",{"aria-hidden":"true",className:"mt-4",children:e.jsx("div",{className:"overflow-hidden rounded-full bg-gray-200",children:e.jsx("div",{style:{width:`${t}%`},className:"h-2 rounded-full bg-primary-600"})})})]})};function S({label:s,name:r,...t}){const o=c.useId();return e.jsxs("label",{htmlFor:o,className:"flex items-center border-gray-400/70 border rounded-md py-3 px-4 w-full hover:ring-[2px] hover:ring-neutral-800 relative",children:[e.jsx("input",{id:o,name:r,type:"radio",...t}),e.jsx("span",{className:"ml-3 block text-sm font-medium leading-6 text-gray-800",children:s})]})}function F({children:s,onChange:r=()=>null,value:t="",...o}){const m=c.useId();return e.jsx("fieldset",{...o,children:c.Children.map(s,n=>c.cloneElement(n,{name:`radio-group-${m}`,checked:n.props.value===t,onChange:i=>r(i.target.value)}))})}const $=4,I={"0_39":"stroke-red-500","40_69":"stroke-yellow-500","70_100":"stroke-green-500"};function q({percentage:s,size:r=92}){const{center:t,radius:o,dashArray:m,dashOffset:n}=c.useMemo(()=>{const d=r/2,a=d-$,u=2*Math.PI*a,x=u*((100-s)/100);return{center:d,radius:a,dashArray:u,dashOffset:x}},[s]),i=Object.keys(I).find(d=>{const[a,u]=d.split("_").map(Number);return s>=a&&s<=u});return e.jsxs("div",{className:"flex items-center justify-center relative",children:[e.jsx("span",{className:"absolute text-md text-gray-400 font-semibold",children:L(s/100,{style:"percent",maximumFractionDigits:0})}),e.jsxs("svg",{className:"-rotate-90",style:{width:r,height:r},children:[e.jsx("circle",{className:"stroke-[4px] fill-transparent stroke-gray-400/40",cx:t,cy:t,r:o}),e.jsx("circle",{className:y("stroke-[4px] fill-transparent",I[i]),cx:t,cy:t,r:o,strokeDasharray:m,strokeDashoffset:n})]})]})}const G=s=>{const{results:r,htmlTemplate:t=!1}=s,o=r.reduce((n,i)=>({...n,...i.recommendationsByArea}),{}),m=()=>{document.getElementById(D.paymentForm)?.showModal()};return e.jsxs("div",{className:"relative max-w-screen-md mx-auto py-10 px-4",children:[e.jsx("h1",{className:"text-4xl font-bold",children:"Tus fortalezas de liderazgo"}),e.jsx("p",{className:"font-light text-md my-2 text-gray-600",children:"Terminaste el test de liderazgo LEAD. Estos son tus resultados en porcentajes de 0 a 100%, según tu grado de desarrollo para cada competencia."}),e.jsxs("section",{className:"my-10 space-y-2",children:[e.jsx("h2",{className:"text-xl font-bold",children:"Tus fortalezas para construir"}),e.jsx("div",{className:y("grid gap-2",{"grid-cols-1 md:grid-cols-2":!t,"grid-cols-2":t}),children:r.sort((n,i)=>i.percentage-n.percentage).map((n,i)=>{const d=P[Number(n.section)];return e.jsxs("article",{className:"p-4 border border-gray-200 rounded-md",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"font-bold",children:d}),e.jsx(q,{percentage:n.percentage,size:64})]}),e.jsx("p",{className:"font-light text-sm leading-6 text-gray-600",children:n.recommendations})]},i)})})]}),e.jsxs("section",{children:[e.jsxs("header",{className:"space-y-2 px-2 pt-4 pb-8 border-b border-primary-100",children:[e.jsx("h2",{className:"text-xl font-bold",children:"Fortalezas para construir"}),e.jsx("p",{className:"font-light text-sm my-2 text-gray-600",children:"Utilice estas recomendaciones para desarrollar sus habilidades de liderazgo. céntrese en un área a la vez y establezca objetivos específicos para seguir su progreso"})]}),e.jsx("ul",{className:"flex flex-col gap-2 list-none",children:Object.entries(o).map(([n,i],d)=>{const a=_[Number(n)];return e.jsxs("li",{className:"p-2",children:[e.jsx("h3",{className:"text-sm font-semibold",children:a}),e.jsx("ul",{className:"list-decimal text-sm flex flex-col gap-y-6 ml-4 mt-4 text-gray-600",children:i.map((u,x)=>e.jsx("li",{className:"leading-5",children:u},x))})]},d)})})]}),e.jsx("footer",{className:y("h-40 absolute inset-0 mt-auto top-0 flex justify-center items-center bg-gradient-to-t from-[#f7f5f2] from-40% to-100% to-transparent",{hidden:t}),children:e.jsx(b,{className:"max-w-xs",onClick:m,children:"Ver más"})})]})},U=({key:s})=>{const r=z[s],[t,o]=c.useState([]),[m,n]=c.useState(1),[i,d]=c.useState(),a=c.useMemo(()=>[],[]),u=r.length,x=t[m-1],N=x?r?.find(l=>l.id===x.id):i,j=w(`${s}:lastQuestionId`),p=c.useRef(j),v=()=>{if(!a.length)return null;if(p.current)return a.find(g=>g.id===p.current);const l=Math.floor(Math.random()*a.length),h=a[l];return p.current=h.id,h},E=()=>{const l=w(`${s}:answers`),h=l?.map(f=>f.id)??[];r.filter(f=>!h.includes(f.id)).forEach(f=>{a.push(f)}),l?.length&&(o(l),n(a.length?l.length+1:l.length));const g=v();g&&d(g)},T=()=>{const l=a.findIndex(g=>g.id===p.current);a.splice(l,1),p.current=null;const h=v();h&&d(h)},O=l=>{if(!N)return;const h={id:N.id,value:l},g=t.findIndex(R=>R.id===h.id),f=structuredClone(t);g!==-1?f[g]=h:(T(),f.push(h)),o(f),A(`${s}:answers`,f)},k=()=>{if(m!==u){if(!x){alert("Por favor selecciona una respuesta");return}n(l=>Math.min(l+1,u))}},C=()=>{n(l=>Math.max(1,l-1))};return c.useEffect(()=>{E()},[]),c.useEffect(()=>{A(`${s}:lastQuestionId`,p.current)},[i]),{total:u,count:m,answer:x,answers:t,question:N,handleNextQuestion:k,handlePrevQuestion:C,saveAnswer:O}},Q={yes:"Sí",no:"No"},K=()=>{const{total:s,count:r,answer:t,answers:o,saveAnswer:m,question:n,handleNextQuestion:i,handlePrevQuestion:d}=U({key:B.LIDERAZGO}),[a,u]=c.useState(null),x=async()=>{const j=await fetch("/api/results/test_liderazgo",{method:"POST",body:JSON.stringify({answers:o})});if(!j.ok){console.error("Error submitting answers",j.statusText);return}const p=await j.json();u(p)},N=async()=>{if(r===s){await x();return}i()};return c.useEffect(()=>{o.length&&o.length===s&&!a&&x()},[o]),a?e.jsx(G,{results:a}):e.jsxs("div",{className:"w-full flex flex-col gap-3",children:[e.jsx(M,{question:r,totalQuestions:s}),e.jsx("h1",{className:"text-lg font-bold mt-8",children:n?.label}),e.jsxs(F,{value:t?.value??"",onChange:j=>m(j),className:"flex flex-col gap-3 mt-4",children:[e.jsx(S,{label:"Si",value:Q.yes}),e.jsx(S,{label:"No",value:Q.no})]}),e.jsxs("footer",{className:"flex items-center justify-end gap-x-2 self-end mt-4",children:[e.jsx(b,{variant:"secondary",onClick:d,children:"Back"}),e.jsx(b,{onClick:N,children:"Next"})]})]})};export{K as default};
